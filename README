developed from the 1.9.3 trunk, pre 1.9 may not work
